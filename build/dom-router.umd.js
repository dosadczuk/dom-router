(function(n){typeof define=="function"&&define.amd?define(n):n()})(function(){"use strict";var n;(function(t){t.Init="data-router",t.Cloak="data-router-cloak",t.Title="data-router-title",t.Link="data-router-link",t.Page="data-router-page"})(n||(n={}));const p=new Map,u=(t,e)=>{p.set(t,e)},l=t=>{const e=p.get(t);e!=null&&e()},C=t=>L().includes(t),L=()=>Array.from(p.keys());var s;(function(t){t.Initialize="router:initialize",t.Initialized="router:initialized",t.ChangePage="router:change-page",t.ChangeView="router:change-view"})(s||(s={}));const g=(t,e,i)=>(t.addEventListener(e,i),()=>{t.removeEventListener(e,i)}),a=(t,e,i)=>{t.dispatchEvent(new CustomEvent(e,{detail:i,bubbles:!0,composed:!0,cancelable:!0}))};function b(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var i,r,o,c,f=[],d="",E=t.split("/");for(E[0]||E.shift();o=E.shift();)i=o[0],i==="*"?(f.push("wild"),d+="/(.*)"):i===":"?(r=o.indexOf("?",1),c=o.indexOf(".",1),f.push(o.substring(1,~r?r:~c?c:o.length)),d+=!!~r&&!~c?"(?:/([^/]+?))?":"/([^/]+?)",~c&&(d+=(~r?"?":"")+"\\"+o.substring(c))):d+="/"+o;return{keys:f,pattern:new RegExp("^"+d+(e?"(?=$|/)":"/?$"),"i")}}const m=()=>new URL(window.location.href),w=(t,e=m())=>b(t).pattern.test(e.pathname);u(n.Init,()=>{a(document,s.Initialize),g(document,s.ChangePage,t=>{const{detail:e}=t;w(e,m())||(history.pushState(null,"",e),a(document,s.ChangeView))}),g(window,"popstate",()=>{a(document,s.ChangeView)}),a(document,s.ChangeView),a(document,s.Initialized)});const v=t=>T(t)?t.length==0:t==null,T=t=>typeof t=="string",k=t=>t instanceof HTMLTemplateElement,y=t=>t instanceof HTMLAnchorElement,h=t=>{const e=document.querySelectorAll(`[${t}]`);return e.length===0?[]:Array.from(e,i=>{const r=Array.from(i.attributes),o=new Map;for(const{name:c,value:f}of r)C(c)&&o.set(c,f);return{content:i,directives:o}})},A=t=>{const{content:e}=t;if(!k(e))return;const i=e.content.firstElementChild;i!=null&&(t.content.replaceWith(i),t.content=i)},I=t=>{const{content:e,directives:i}=t;if(k(e))return;const r=document.createElement("template");r.content.append(e.cloneNode(!0)),i.forEach((o,c)=>{r.setAttribute(c,o)}),t.content.replaceWith(r),t.content=r};u(n.Cloak,()=>{const t=h(n.Cloak);if(t.length!==0)for(const e of t)e.content.removeAttribute(n.Cloak)}),u(n.Link,()=>{const t=h(n.Link);t.length!==0&&t.forEach(({content:e,directives:i})=>{let r=i.get(n.Link);v(r)&&y(e)&&(r=e.href),r!=null&&e.addEventListener("click",o=>{o.preventDefault(),a(document,s.ChangePage,r)})})}),u(n.Page,()=>{const t=h(n.Page);t.length!==0&&g(document,s.ChangeView,()=>{const e=m();for(const i of t){const r=i.directives.get(n.Page);r!=null&&(w(r,e)?A(i):I(i))}})}),u(n.Title,()=>{const t=h(n.Title);if(t.length===0)return;const e=document.documentElement.getAttribute(n.Title);g(document,s.ChangeView,()=>{const i=m();for(const r of t){const o=r.directives.get(n.Page),c=r.directives.get(n.Title);if(!(o==null||c==null)&&w(o,i)){e!=null?document.title=e.replace("{title}",c):document.title=c;break}}})}),(()=>{if(!document.documentElement.hasAttribute(n.Init))return console.warn(`Router cannot be initialized. Add '${n.Init}' attribute to <html></html> tag.`);l(n.Cloak),l(n.Title),l(n.Page),l(n.Link),l(n.Init)})()});
